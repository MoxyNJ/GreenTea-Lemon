# [ä¸€] React åŸºç¡€çŸ¥è¯†

# 0 React åŸºæœ¬

## 0.1 å¼•è¨€

### 0.1.1 React çš„ç‰¹ç‚¹

1. å£°æ˜å¼ç¼–ç¨‹
2. ç»„ä»¶åŒ–ç¼–ç¨‹
3. React Nativeç¼–å†™åŸç”Ÿåº”ç”¨ 
   -  *React Native (ç®€ç§°RN)æ˜¯Facebookäº2015å¹´4æœˆå¼€æºçš„è·¨å¹³å°ç§»åŠ¨åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œæ˜¯Facebookæ—©å…ˆå¼€æºçš„JSæ¡†æ¶ React åœ¨åŸç”Ÿç§»åŠ¨åº”ç”¨å¹³å°çš„è¡ç”Ÿäº§ç‰©*
4. é«˜æ•ˆ (ä¼˜ç§€çš„ Diffing ç®—æ³•)



### 0.1.2 React é«˜æ•ˆçš„åŸå› 

1. ä½¿ç”¨è™šæ‹Ÿ (virtual) DOM ï¼Œä¸æ€»æ˜¯ç›´æ¥æ“ä½œé¡µé¢çœŸå® DOMã€‚
2. DOM Diffing ç®—æ³•,æœ€å°åŒ–é¡µé¢é‡ç»˜

**æ³¨æ„ï¼šReact å¹¶ä¸ä¼šæé«˜æ¸²æŸ“é€Ÿåº¦ï¼Œåè€Œå¯èƒ½ä¼šå¢åŠ æ¸²æŸ“æ—¶é—´ã€‚çœŸæ­£é«˜æ•ˆçš„åŸå› æ˜¯å®ƒèƒ½æœ‰æ•ˆå‡å°‘æ¸²æŸ“æ¬¡æ•°**ã€‚

### 

### 0.1.3 åˆ›å»ºè™šæ‹Ÿ DOM

```jsx
//1.åˆ›å»ºè™šæ‹ŸDOM
	const VDOM = (  /* æ­¤å¤„ä¸€å®šä¸è¦å†™å¼•å·ï¼Œå› ä¸ºä¸æ˜¯å­—ç¬¦ä¸² */
    	<h1 id="title">
		    <span>Hello,React</span>
		</h1>
	)
//2.æ¸²æŸ“è™šæ‹ŸDOMåˆ°é¡µé¢
	ReactDOM.render(VDOM,document.getElementById('test'))

//3.æ‰“å°çœŸå®DOMä¸è™šæ‹ŸDOM,è¿™ä¸€æ­¥ä¸æ˜¯jsxåˆ›å»ºè™šæ‹Ÿdomå¿…é¡»ï¼Œæˆ‘åªæ˜¯ä¸ºäº†æ–¹ä¾¿æŸ¥é˜…
	const TDOM = document.getElementById('demo')
    console.log('è™šæ‹ŸDOM',VDOM);
	console.log('çœŸå®DOM',TDOM);
```

è™šæ‹Ÿ DOMï¼š

1. æœ¬è´¨æ˜¯ Object ç±»å‹çš„å¯¹è±¡(ä¸€èˆ¬å¯¹è±¡)
2. è™šæ‹Ÿ DOM æ¯”è¾ƒ **'è½»'**  , çœŸå® DOM æ¯”è¾ƒ **'é‡'** , å› ä¸ºè™šæ‹Ÿ DOM æ˜¯ React å†…éƒ¨åœ¨ç”¨ , æ— éœ€çœŸå® DOM ä¸Šé‚£ä¹ˆå¤šçš„å±æ€§ (åªæœ‰ React éœ€è¦çš„å±æ€§)ã€‚
3. è™šæ‹Ÿ DOM æœ€ç»ˆä¼šè¢« React è½¬åŒ–ä¸ºçœŸå® DOM , å‘ˆç°åœ¨é¡µé¢ä¸Šã€‚



### 0.1.4 jsx åŸºæœ¬è¯­æ³•ï¼š

1. å®šä¹‰è™šæ‹Ÿ DOM æ—¶ï¼Œä¸è¦å†™å¼•å· `""`ï¼›
2. æ ‡ç­¾ä¸­æ··å…¥ JS è¡¨è¾¾å¼æ—¶è¦ç”¨ `{}`ï¼›
3. æ ·å¼çš„ç±»åæŒ‡å®šä¸è¦ç”¨ `class`ï¼Œè¦ç”¨ `className`ï¼›
4. å†…è”æ ·å¼ï¼Œè¦ç”¨ `style={{key:value}}` çš„å½¢å¼ (åŒ `{{}}` ä»£è¡¨å¯¹è±¡ï¼Œå• `{}` ä»£è¡¨ JS è¡¨è¾¾å¼) ï¼›
5. æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾ (æ•´ä¸ªè™šæ‹Ÿ DOM åœ¨å¤–å±‚æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå®¹å™¨åŒ…è£¹)ï¼›
6. æ ‡ç­¾å¿…é¡»é—­åˆ `<demo />`
7. æ ‡ç­¾é¦–çš„å­—æ¯ï¼š
   - è‹¥ **å°å†™å­—æ¯** å¼€å¤´ï¼ŒReact ä¼šè¯†åˆ«ä¸º html ä¸­åŒåå…ƒç´ ã€‚è‹¥ html ä¸­æ— å¯¹åº”çš„åŒåå…ƒç´ ï¼Œåˆ™ **æŠ¥é”™**ã€‚
   - è‹¥ **å¤§å†™å­—æ¯** å¼€å¤´ï¼ŒReact ä¼šè¯†åˆ«ä¸ºä¸€ä¸ªç»„ä»¶ï¼Œç„¶åä¼šæŸ¥æ‰¾ç„¶åæ¸²æŸ“å¯¹åº”ç»„ä»¶ï¼Œè‹¥ç»„ä»¶æ²¡æœ‰å®šä¹‰ï¼Œåˆ™ **æŠ¥é”™**ã€‚



### 0.1.5 å¼€å¤´å¼•å…¥çš„ script æ–‡ä»¶ï¼š

1. å‡†å¤‡å¥½ä¸€ä¸ªå®¹å™¨ï¼Œæ”¾ç½® React æ¸²æŸ“çš„ DOMï¼›
2. å¼•å…¥ä¸‰ä¸ªåº“ï¼š
   - react æ ¸å¿ƒåº“ï¼š`react.development.js`ï¼›
   - react-dom åº“ï¼š`react-dom.development.js`ï¼›
     - babel åº“ï¼š`babel.min.js`ã€‚
3. å†™ react ä»£ç ï¼Œåœ¨ `<script type="text/babel" ></script>` ä¸­ï¼Œä¸€å®šè¦å†™ `babel`ï¼Œå¦åˆ™ä¸ä¼šè°ƒç”¨ babel æŠŠ jsx è¯­æ³•è½¬åŒ–ä¸º js è¯­æ³•ã€‚
   - åˆ›å»ºè™šæ‹Ÿ DOM
   - æ¸²æŸ“è™šæ‹Ÿ DOM

```jsx
<body>
	<!-- å‡†å¤‡å¥½ä¸€ä¸ªâ€œå®¹å™¨â€ -->
	<div id="test"></div>

	<!-- å¼•å…¥reactæ ¸å¿ƒåº“ -->
	<script type="text/javascript" src="react.development.js"></script>
	<!-- å¼•å…¥react-domï¼Œç”¨äºæ”¯æŒreactæ“ä½œDOM -->
	<script type="text/javascript" src="react-dom.development.js"></script>
	<!-- å¼•å…¥babelï¼Œç”¨äºå°†jsxè½¬ä¸ºjs -->
	<script type="text/javascript" src="babel.min.js"></script>

	<script type="text/babel" > /* æ­¤å¤„ä¸€å®šè¦å†™babel */
		// 1.åˆ›å»ºè™šæ‹ŸDOM
		const VDOM = (  /* æ­¤å¤„ä¸€å®šä¸è¦å†™å¼•å·ï¼Œå› ä¸ºä¸æ˜¯å­—ç¬¦ä¸² */
			<h1 id="title">
				<span>Hello,React</span>
			</h1>
		)
		
        // 2.æ¸²æŸ“è™šæ‹ŸDOMåˆ°é¡µé¢
		ReactDOM.render(VDOM,document.getElementById('test'))
	</script>
</body>
```





# 1 ç±»å¼ç»„ä»¶çš„ç»“æ„ï¼š

1. å¿…é¡» **ç»§æ‰¿**ã€‚ `React.Component` ï¼›
2. å¿…é¡»æœ‰ **æ¸²æŸ“æ–¹æ³•**ã€‚ `render(){ return ...}`ï¼Œåœ¨ render ä¸­è¿”å›ä¸€ä¸ª HTML ç»“æ„ã€‚
3. å¯ä»¥æœ‰ **è‡ªå®šä¹‰æ–¹æ³•**ï¼Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œè‡ªå®šä¹‰æ–¹æ³•ä¸­çš„ thisï¼Œæ²¡æœ‰æŒ‡å‘å½“å‰å®ä¾‹å¯¹è±¡ã€‚å› ä¸ºè¿™ä¸ªæ–¹æ³•ä¸æ˜¯é€šè¿‡ `p1.callName()` çš„æ–¹æ³•è°ƒç”¨çš„ã€‚ä¹Ÿå°±æ˜¯è¯´è°ƒç”¨è€…ä¸æ˜¯å®ä¾‹å¯¹è±¡ï¼Œè€Œæ˜¯ React ç›´æ¥è°ƒç”¨çš„ã€‚
   - è§£å†³æ–¹æ¡ˆï¼š`this.changeWeather = this.changeWeather.bind(this)`ï¼Œä½¿ç”¨ bind å‡½æ•°ï¼ŒæŠŠè¿™ä¸ª `changeWeather`  çš„ this å¼ºåˆ¶ç»‘å®šåˆ°è¿™ä¸ªå®ä¾‹å¯¹è±¡ä¸Šã€‚



### ä¸€ä¸ªç±»å¼ç»„ä»¶çš„å®ä¾‹å¯¹è±¡çš„ç»“æ„ï¼š

![image-20211007144501255](%E6%88%91%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%9C%8B%E7%9A%84%E7%AC%94%E8%AE%B0/image-20211007144501255-16335891033111.png)

### `consructor` 

æ„é€ å‡½æ•°ï¼Œä»…ç”¨äºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š

1. é€šè¿‡ç»™ `this.state` èµ‹å€¼å¯¹è±¡æ¥åˆå§‹åŒ–å†…éƒ¨ `state`ã€‚
2. ä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ç»‘å®šå®ä¾‹ã€‚ 

- æ‰€ä»¥ï¼Œæ„é€ å™¨å¯ä»¥ç›´æ¥çœç•¥ï¼š

1. åˆå§‹åŒ– `state`ï¼Œå¯ä»¥é‡‡ç”¨ç®€å†™çš„å½¢å¼ï¼Œç›´æ¥åœ¨ç±»ä¸­å®šä¹‰å±æ€§ `state = {...}`
2. äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œé€šè¿‡ç›´æ¥åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªå±æ€§ï¼Œèµ‹å€¼ç®­å¤´å‡½æ•°è¡¨è¾¾å¼ï¼š`changeWeather = () => {}`ï¼Œæ—¢å¯ä»¥è§£å†³ this é—®é¢˜ï¼Œåˆçœç•¥äº† constructorã€‚

å¦‚æœå£°æ˜äº†æ„é€ å™¨ï¼Œä½†æ˜¯å¿˜è®°è°ƒç”¨ `super(props)`ï¼Œå°±ä¼šäº§ç”Ÿ bugï¼Œå¿…é¡»è°ƒç”¨ `super()`ï¼Œä¸”ä¼ é€’ `props`ã€‚



### context

è¿˜æœªè®²è§£ã€‚



### props 

æ ‡ç­¾å±æ€§ï¼Œç»„å»ºå®ä¾‹çš„ä¸‰å¤§å±æ€§ä¹‹ä¸€ã€‚ç”¨äºä¼ é€’æ ‡ç­¾å±æ€§ã€‚åœ¨ `constructor(props)`  ä¸­å¯ä»¥æ¥å—åˆ° propsï¼ŒæŠŠ props é€šè¿‡ `super(props)` 

- props æ˜¯ **åªè¯»** çš„ã€‚

- é€šå¸¸ç”¨å­—ç¬¦ä¸²å±•å¼€æ¥ä¼ é€’å±æ€§ï¼Œæ³¨æ„ä¼ é€’æ•°å­—çš„æ—¶å€™ï¼Œè¦ç”¨ `{}`ï¼›
- å¯ä»¥å¯¹æ¥æ”¶çš„æ•°æ®ç±»å‹è¿›è¡Œé™åˆ¶ã€‚åœ¨ç±»ç»„ä»¶ä¸­ï¼Œç”¨é™æ€å¯¹è±¡ `static propTypes = {}`ï¼›åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œç”¨å±æ€§ `Person.propTyps = {}`ï¼›
- å¯ä»¥å¯¹æ¥æ”¶çš„æ•°æ®æ·»åŠ é»˜è®¤å±æ€§ã€‚åœ¨ç±»ç»„ä»¶ä¸­ï¼Œç”¨é™æ€å¯¹è±¡ `static defaultProps = {}`ï¼›åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œç”¨å±æ€§ `Person.defaultProps = {}`ï¼›



### refs

æ ‡ç­¾åå±æ€§ï¼Œç»„ä»¶å®ä¾‹çš„ä¸‰å¤§å±æ€§ä¹‹ä¸€ã€‚ç»„ä»¶å†…çš„æ ‡ç­¾ï¼Œå¯ä»¥å®šä¹‰ ref å±æ€§æ¥æ ‡è¯†è‡ªå·±ã€‚è¿™ç›¸å½“äº HTML ä¸­çš„ ID å±æ€§ã€‚

refs çš„æœ€ä½³å®è·µï¼Œå®˜æ–¹æœ€æ–°ç‰ˆæœ¬çš„ createRef APIã€‚

refs è¦å°½é‡å°‘ä½¿ç”¨ï¼Œå¤šä½¿ç”¨äº‹ä»¶æœºåˆ¶ã€‚å½“å‘ç”Ÿäº‹ä»¶çš„å…ƒç´ ï¼Œå°±æ˜¯è¦è§¦å‘äº‹ä»¶åè¿›è¡Œæ“ä½œçš„å…ƒç´ æœ¬èº«ï¼Œå°±å¯ä»¥çœç•¥ refï¼Œä½¿ç”¨ `event.target.value`ï¼ˆè¯¾ç¨‹P32ï¼Œ7:00ï¼Œäº‹ä»¶å¤„ç†ï¼‰



### state

çŠ¶æ€ï¼Œç»„ä»¶å®ä¾‹çš„ä¸‰å¤§å±æ€§ä¹‹ä¸€ã€‚å­˜å‚¨ç€ç»„ä»¶çš„æ•°æ®ã€‚

- æœ‰ä¸¤ç§å†™æ³•ï¼šæ­£å¸¸å†™å’Œç®€å†™ã€‚
  - ç®€å†™ä¸éœ€è¦ `constructor` å’Œé€šè¿‡ `bind` ç»‘å®šè§£å†³è‡ªå®šä¹‰å‡½æ•°çš„ `this` æ‰§è¡Œé—®é¢˜ã€‚
    - `constructor` å¤–éƒ¨é€šè¿‡å±æ€§åå®šä¹‰çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œæœ€åå®šä¹‰åœ¨äº†å®ä¾‹åŒ–å¯¹è±¡ä¸Šã€‚æ‰€ä»¥ï¼Œé€šè¿‡ç®­å¤´å‡½æ•°å»å®šä¹‰çš„ **å‡½æ•°è¡¨è¾¾å¼**ï¼Œå®ƒçš„ `this` å°±æ ¹æ®å®šä¹‰è¿™ä¸ªå‡½æ•°æ—¶çš„ä½ç½®ï¼ŒæŒ‡å‘äº†å®ä¾‹å¯¹è±¡ï¼Œè¿™æ ·å°±çœç•¥äº† `bind` å»ç»‘å®š `this` çš„æŒ‡å‘ã€‚
- ä¿®æ”¹ `this.state`ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Œé€šè¿‡ `this.setState()`  ä¿®æ”¹ã€‚



# 2 ç»„ä»¶é—´çš„çˆ¶å­å…³ç³»

### 2.1 å»ºç«‹çˆ¶å­ç»„ä»¶å…³ç³»

æ–¹å¼ä¸€ï¼š

åœ¨çˆ¶ç»„ä»¶çš„ `render()` çš„ `return` ä¸­ï¼Œå½¢æˆçˆ¶å­å…³ç³»çš„ DOM ç»“æ„ã€‚

```jsx
//çˆ¶ç»„ä»¶A
class A extends React.Component{
    render(){
        return(
            <div>
                <div>æˆ‘æ˜¯Aç»„ä»¶</div>
                <B/>
            </div>
        )
    }
}

//å­ç»„ä»¶B
class B extends React.Component{
    render(){
        console.log('B---render');
        return(
            <div>æˆ‘æ˜¯Bç»„ä»¶</div>
        )
    }
}

//æ¸²æŸ“ç»„ä»¶
ReactDOM.render(<A/>,document.getElementById('test'))
```



###   2.2 ç»„ä»¶é—´é€šä¿¡ï¼š

æ–¹å¼ä¸€ï¼šprops

æ–¹å¼äºŒï¼šè¿˜æœªè®²è§£ã€‚



# 3 ä»£ç ç¤ºä¾‹

## 3.1 State

å¤´éƒ¨æ–‡ä»¶ï¼š

```js
<div id="test1"></div>
<script type="text/javascript" src="../js/react.development.js"></script>
<script type="text/javascript" src="../js/react-dom.development.js"></script>
<script type="text/javascript" src="../js/babel.min.js"></script>
```

è§„èŒƒå†™æ³•ï¼Œç¹çï¼š

```jsx
class Weather extends React.Component{
	constructor(props){
		console.log('constructor');
		super(props)
		//åˆå§‹åŒ–çŠ¶æ€
		this.state = {isHot:false,wind:'å¾®é£'}
		//è§£å†³changeWeatherä¸­thisæŒ‡å‘é—®é¢˜
		this.changeWeather = this.changeWeather.bind(this)
	}

	render(){
		//è¯»å–çŠ¶æ€
		const {isHot,wind} = this.state
		return <h1 onClick={this.changeWeather}>ä»Šå¤©å¤©æ°”å¾ˆ{isHot ? 'ç‚çƒ­' : 'å‡‰çˆ½'}ï¼Œ{wind}</h1>
	}

	changeWeather(){
		//changeWeatheræ”¾åœ¨åŸå‹å¯¹è±¡ä¸Šï¼Œä¾›å®ä¾‹ä½¿ç”¨
		//ç”±äºchangeWeatheræ˜¯ä½œä¸ºonClickçš„å›è°ƒï¼Œæ‰€ä»¥ä¸æ˜¯é€šè¿‡å®ä¾‹è°ƒç”¨çš„ï¼Œæ˜¯ç›´æ¥è°ƒç”¨
		//ç±»ä¸­çš„æ–¹æ³•é»˜è®¤å¼€å¯äº†å±€éƒ¨çš„ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€ä»¥changeWeatherä¸­çš„thisä¸ºundefined
		
		//è·å–åŸæ¥çš„isHotå€¼
		const {isHot} = this.state
		//ä¸¥é‡æ³¨æ„ï¼šçŠ¶æ€å¿…é¡»é€šè¿‡setStateè¿›è¡Œæ›´æ–°,ä¸”æ›´æ–°æ˜¯ä¸€ç§åˆå¹¶ï¼Œä¸æ˜¯æ›¿æ¢ã€‚
		this.setState({isHot:!isHot})
	}
}

ReactDOM.render(<Weather/>,document.getElementById('test'))
```

### 1 æœ€ä½³å®è·µï¼š

ç®€å†™ï¼Œè§£å†³ bind å’Œ constructorï¼š

```jsx
class Weather extends React.Component{
    //åˆå§‹åŒ–çŠ¶æ€
    state = {isHot:false,wind:'å¾®é£'}

    render(){
        const {isHot,wind} = this.state
        return <h1 onClick={this.changeWeather}>ä»Šå¤©å¤©æ°”å¾ˆ{isHot ? 'ç‚çƒ­' : 'å‡‰çˆ½'}ï¼Œ{wind}</h1>
    }

	// è‡ªå®šä¹‰æ–¹æ³•â€”â€”â€”â€”è¦ç”¨èµ‹å€¼è¯­å¥çš„å½¢å¼ + ç®­å¤´å‡½æ•°
    // changeWeather æ”¾åœ¨å®ä¾‹å¯¹è±¡ä¸Šï¼Œè€Œä¸åœ¨åŸå‹å¯¹è±¡ã€‚è¿™æ ·é€šè¿‡ç®­å¤´å‡½æ•°ï¼Œ this å°±å›ºå®šæŒ‡å‘äº†å®ä¾‹å¯¹è±¡ã€‚
    changeWeather = ()=>{
        const isHot = this.state.isHot
        this.setState({isHot:!isHot})
    }
}

ReactDOM.render(<Weather/>,document.getElementById('test'))
```



## 3.2 props

å¤´éƒ¨æ–‡ä»¶ï¼š

```jsx
<div id="test1"></div>
<script type="text/javascript" src="../js/react.development.js"></script>
<script type="text/javascript" src="../js/react-dom.development.js"></script>
<script type="text/javascript" src="../js/babel.min.js"></script>

// å¦‚æœéœ€è¦å¯¹propsè¿›è¡Œé™åˆ¶å’Œå®šä¹‰é»˜è®¤å€¼ï¼Œéœ€è¦è°ƒç”¨ prop-typesåº“ï¼š
<script type="text/javascript" src="../js/prop-types.js"></script>
```

### 1 ç»å…¸ç”¨æ³•ï¼š

ç›´æ¥çœç•¥äº† constructor å¯¹ props çš„ä¼ é€’ã€‚

```jsx
//åˆ›å»ºç»„ä»¶
class Person extends React.Component{
    render(){
        // console.log(this);
        const {name,age,sex} = this.props
        return (
            <ul>
                <li>å§“åï¼š{name}</li>
                <li>æ€§åˆ«ï¼š{sex}</li>
                <li>å¹´é¾„ï¼š{age+1}</li>
            </ul>
        )
    }
}
//æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
ReactDOM.render(<Person name="jerry" age={19}  sex="ç”·"/>,document.getElementById('test1'))

const p = {name:'è€åˆ˜',age:18,sex:'å¥³'}
// é€šè¿‡æ‰©å±•è¿ç®—ç¬¦ï¼Œæµ…æ‹·è´å¯¹è±¡ï¼Œè¾¾åˆ°ä¼ é€’å€¼çš„ç›®çš„ï¼Œæ›´ç®€æ´ã€‚
ReactDOM.render(<Person {...p}/>,document.getElementById('test3'))
// ä¼ ç»Ÿæ–¹æ³•ï¼Œå¤ªç¹çã€‚
// ReactDOM.render(<Person name={p.name} age={p.age} sex={p.sex}/>,document.getElementById('test3'))
```

### 2 å¯¹ props è¿›è¡Œé™åˆ¶ï¼š

åœ¨ç±»ä¸­ï¼š

```jsx
class Person extends React.Component{
    render(){
        // console.log(this);
        const {name,age,sex} = this.props
        //propsæ˜¯åªè¯»çš„
        //this.props.name = 'jack' //æ­¤è¡Œä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºpropsæ˜¯åªè¯»çš„
        return (
            <ul>
                <li>å§“åï¼š{name}</li>
                <li>æ€§åˆ«ï¼š{sex}</li>
                <li>å¹´é¾„ï¼š{age+1}</li>
			</ul>
		)
	}
}
//å¯¹æ ‡ç­¾å±æ€§è¿›è¡Œç±»å‹ã€å¿…è¦æ€§çš„é™åˆ¶
Person.propTypes = {
    name:PropTypes.string.isRequired, //é™åˆ¶nameå¿…ä¼ ï¼Œä¸”ä¸ºå­—ç¬¦ä¸²
    sex:PropTypes.string,//é™åˆ¶sexä¸ºå­—ç¬¦ä¸²
    age:PropTypes.number,//é™åˆ¶ageä¸ºæ•°å€¼
    speak:PropTypes.func,//é™åˆ¶speakä¸ºå‡½æ•°
}
//æŒ‡å®šé»˜è®¤æ ‡ç­¾å±æ€§å€¼
Person.defaultProps = {
    sex:'ç”·',//sexé»˜è®¤å€¼ä¸ºç”·
    age:18 //ageé»˜è®¤å€¼ä¸º18
}
//æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
ReactDOM.render(<Person name={100} speak={speak}/>,document.getElementById('test1'))

function speak(){
    console.log('æˆ‘è¯´è¯äº†');
}
```

### 3 ç±»ç»„ä»¶çš„æœ€ä½³å®è·µï¼š

åœ¨ç±»ä¸­ï¼Œç»å¸¸é‡‡ç”¨ä»¥ä¸‹æ–¹å¼ç®€å†™ï¼š

```jsx
class Person extends React.Component{
	//å¯¹æ ‡ç­¾å±æ€§è¿›è¡Œç±»å‹ã€å¿…è¦æ€§çš„é™åˆ¶
	static propTypes = {
		name:PropTypes.string.isRequired, //é™åˆ¶nameå¿…ä¼ ï¼Œä¸”ä¸ºå­—ç¬¦ä¸²
		sex:PropTypes.string,//é™åˆ¶sexä¸ºå­—ç¬¦ä¸²
		age:PropTypes.number,//é™åˆ¶ageä¸ºæ•°å€¼
	}

	//æŒ‡å®šé»˜è®¤æ ‡ç­¾å±æ€§å€¼
	static defaultProps = {
		sex:'ç”·',//sexé»˜è®¤å€¼ä¸ºç”·
		age:18 //ageé»˜è®¤å€¼ä¸º18
	}
	
	render(){
        // propsæ˜¯åªè¯»çš„
		const {name,age,sex} = this.props
		//this.props.name = 'jack' //æ­¤è¡Œä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºpropsæ˜¯åªè¯»çš„
		return (
			<ul>
				<li>å§“åï¼š{name}</li>
				<li>æ€§åˆ«ï¼š{sex}</li>
				<li>å¹´é¾„ï¼š{age+1}</li>
			</ul>
		)
	}
}

ReactDOM.render(<Person name="jerry"/>,document.getElementById('test1'))
```

### 4 å‡½æ•°ç»„ä»¶çš„æœ€ä½³å®è·µï¼š

åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œä½¿ç”¨ propsï¼š

```jsx
function Person (props){
	const {name,age,sex} = props
	return (
			<ul>
				<li>å§“åï¼š{name}</li>
				<li>æ€§åˆ«ï¼š{sex}</li>
				<li>å¹´é¾„ï¼š{age}</li>
			</ul>
		)
}
Person.propTypes = {
	name:PropTypes.string.isRequired, //é™åˆ¶nameå¿…ä¼ ï¼Œä¸”ä¸ºå­—ç¬¦ä¸²
	sex:PropTypes.string,//é™åˆ¶sexä¸ºå­—ç¬¦ä¸²
	age:PropTypes.number,//é™åˆ¶ageä¸ºæ•°å€¼
}

//æŒ‡å®šé»˜è®¤æ ‡ç­¾å±æ€§å€¼
Person.defaultProps = {
	sex:'ç”·',//sexé»˜è®¤å€¼ä¸ºç”·
	age:18 //ageé»˜è®¤å€¼ä¸º18
}

ReactDOM.render(<Person name="jerry"/>,document.getElementById('test1'))
```



## 3.3 refs

### 1 è¿‡æ—¶æ–¹å¼ï¼šå­—ç¬¦ä¸²å½¢å¼

å·² **ä¸æ¨èä½¿ç”¨** ï¼š

```jsx
class Demo extends React.Component{
	//å±•ç¤ºå·¦ä¾§è¾“å…¥æ¡†çš„æ•°æ®
	showData = ()=>{
		const {input1} = this.refs
		alert(input1.value)
	}
	//å±•ç¤ºå³ä¾§è¾“å…¥æ¡†çš„æ•°æ®
	showData2 = ()=>{
		const {input2} = this.refs
		alert(input2.value)
	}
	render(){
		return(
			<div>
				<input ref="input1" type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>&nbsp;
				<button onClick={this.showData}>ç‚¹æˆ‘æç¤ºå·¦ä¾§çš„æ•°æ®</button>&nbsp;
				<input ref="input2" onBlur={this.showData2} type="text" placeholder="å¤±å»ç„¦ç‚¹æç¤ºæ•°æ®"/>
			</div>
		)
	}
}
ReactDOM.render(<Demo a="1" b="2"/>,document.getElementById('test'))
```

### 2 å›è°ƒå‡½æ•°å½¢å¼

åœ¨é¡µé¢çš„ state çŠ¶æ€æ›´æ–°æ—¶ï¼Œä¼šè°ƒç”¨ä¸¤æ¬¡ refs çš„å›è°ƒå‡½æ•°ï¼š

1. ç¬¬ä¸€æ¬¡ä¼šæŠŠä¼ é€’çš„å‚æ•°ç½®ä¸º nullï¼Œè¾¾åˆ°æ¸…ç©ºçŠ¶æ€æ›´æ–°å‰çš„æ—§ refs ä¿¡æ¯ï¼›
2. ç¬¬äºŒæ¬¡ä¼šæ­£ç¡®çš„ä¼ é€’èŠ‚ç‚¹ä¿¡æ¯ã€‚

å¦‚æœæŠŠå›è°ƒå‡½æ•°æ”¾åœ¨ class å†…éƒ¨ï¼Œè€Œä¸æ˜¯é‡‡ç”¨å†…è”çš„å½¢å¼ï¼Œå¯ä»¥é¿å…ä¸¤æ¬¡è°ƒç”¨çš„é—®é¢˜ï¼Œä½†äº‹å®ä¸Šä¸¤æ¬¡è°ƒç”¨é—®é¢˜ä¸å¤§ã€‚

```jsx
class Demo extends React.Component{
	//å±•ç¤ºå·¦ä¾§è¾“å…¥æ¡†çš„æ•°æ®
	showData = ()=>{
		const {input1} = this
		alert(input1.value)
	}
	//å±•ç¤ºå³ä¾§è¾“å…¥æ¡†çš„æ•°æ®
	showData2 = ()=>{
		const {input2} = this
		alert(input2.value)
	}
	render(){
		return(
			<div>
				//ref å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œå°±æ˜¯å½“å‰æ ‡ç­¾èŠ‚ç‚¹(input)å¯¹è±¡ã€‚
				//æ‰€ä»¥ï¼Œthis.input1 = c çš„æ„æ€æ˜¯:
				//æŠŠæŒ‡å‘è‡ªèº«èŠ‚ç‚¹å¯¹è±¡çš„æŒ‡é’ˆï¼Œæ”¾åœ¨äº†å®ä¾‹èŠ‚ç‚¹æœ¬èº«çš„input1å±æ€§ä¸Šã€‚
				<input ref={c => this.input1 = c } type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>&nbsp;
				<button onClick={this.showData}>ç‚¹æˆ‘æç¤ºå·¦ä¾§çš„æ•°æ®</button>&nbsp;
				<input onBlur={this.showData2} ref={c => this.input2 = c } type="text" placeholder="å¤±å»ç„¦ç‚¹æç¤ºæ•°æ®"/>&nbsp;
			</div>
		)
	}
}

ReactDOM.render(<Demo a="1" b="2"/>,document.getElementById('test'))
```

### 3 æœ€ä½³å®è·µï¼šcreateRef å½¢å¼

```jsx
class Demo extends React.Component{
/* 
 React.createRefè°ƒç”¨åå¯ä»¥è¿”å›ä¸€ä¸ªå®¹å™¨ï¼Œè¯¥å®¹å™¨å¯ä»¥å­˜å‚¨è¢«refæ‰€æ ‡è¯†çš„èŠ‚ç‚¹,
 è¯¥å®¹å™¨æ˜¯â€œä¸“äººä¸“ç”¨â€çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„createRefå¯¹è±¡ã€‚
*/
	myRef = React.createRef()
	myRef2 = React.createRef()
	//å±•ç¤ºå·¦ä¾§è¾“å…¥æ¡†çš„æ•°æ®
	showData = ()=>{
		alert(this.myRef.current.value);
	}
	//å±•ç¤ºå³ä¾§è¾“å…¥æ¡†çš„æ•°æ®
	showData2 = ()=>{
		alert(this.myRef2.current.value);
	}
	render(){
		return(
    <div>
        <input ref={this.myRef} type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>&nbsp;
        <button onClick={this.showData}>ç‚¹æˆ‘æç¤ºå·¦ä¾§çš„æ•°æ®</button>&nbsp;
        <input onBlur={this.showData2} ref={this.myRef2} type="text" placeholder="å¤±å»ç„¦ç‚¹æç¤ºæ•°æ®"/>&nbsp;
    </div>
		)
	}
}
//æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
ReactDOM.render(<Demo a="1" b="2"/>,document.getElementById('test'))
```



# 3 äº‹ä»¶æœºåˆ¶

react ä¸­çš„äº‹ä»¶æœºåˆ¶æ˜¯é‡‡ç”¨å§”æ‰˜å½¢å¼ã€‚äº‹ä»¶è¢«è§¦å‘åï¼Œä¼šé€šè¿‡å†’æ³¡ï¼Œåœ¨æœ€å¤–å±‚çš„ div ä¸­è§¦å‘ã€‚



## 3.1 éå—æ§ç»„ä»¶

åœ¨è¡¨å•ä¸­ï¼Œæ‰€æœ‰è¾“å…¥ç±»çš„ DOMï¼Œâ€œç°ç”¨ç°å–â€ï¼Œå°±æ˜¯å—æ§ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è·å–åˆ°ç”¨æˆ·è¾“å…¥çš„å†…å®¹åï¼Œç›´æ¥å–å‡ºæ¥ä½¿ç”¨ï¼Œè€Œä¸æ˜¯è¿›è¡Œä¼ é€’ï¼ˆä¸ä¼šè¿›è¡Œè¡¨å•æäº¤çš„è·³è½¬ï¼Œä¸ä¼šè·³è½¬ç½‘é¡µï¼‰ã€‚

```jsx
class Login extends React.Component{
	handleSubmit = (event)=>{
		event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
		const {username,password} = this
       	// é˜»æ­¢æäº¤ï¼Œç„¶åç°å–ç°ç”¨ï¼Œé‡‡ç”¨ ajax æäº¤ã€‚
		alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username.value},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password.value}`)
	}
	render(){
		return(
<form onSubmit={this.handleSubmit}>
	ç”¨æˆ·åï¼š<input ref={c => this.username = c} type="text" name="username"/>
	å¯†ç ï¼š<input ref={c => this.password = c} type="password" name="password"/>
	<button>ç™»å½•</button>
</form>
		)
	}
}
//æ¸²æŸ“ç»„ä»¶
ReactDOM.render(<Login/>,document.getElementById('test'))
```



## 3.2 å—æ§ç»„ä»¶

å—æ§ç»„ä»¶å°±æ˜¯éšç€ç”¨æˆ·çš„è¾“å…¥ï¼ŒæŠŠè¾“å…¥çš„å†…å®¹å…¨éƒ¨æ”¾å…¥ state çŠ¶æ€ä¸­ï¼Œè¿™å°±æ˜¯ â€œåŒå‘æ•°æ®ç»‘å®šâ€ã€‚

å—æ§ç»„ä»¶æ²¡æœ‰ä½¿ç”¨ refï¼ŒåŒæ—¶å¯ä»¥éšæ—¶åœ¨ state è·å–å’Œä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„å†…å®¹ã€‚



```jsx
class Login extends React.Component{
	//åˆå§‹åŒ–çŠ¶æ€
	state = {
		username:'', //ç”¨æˆ·å
		password:'' //å¯†ç 
	}

	//ä¿å­˜ç”¨æˆ·ååˆ°çŠ¶æ€ä¸­
	saveUsername = (event)=>{
		this.setState({username:event.target.value})
	}

	//ä¿å­˜å¯†ç åˆ°çŠ¶æ€ä¸­
	savePassword = (event)=>{
		this.setState({password:event.target.value})
	}

	//è¡¨å•æäº¤çš„å›è°ƒ
	handleSubmit = (event)=>{
		event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
		const {username,password} = this.state
		alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
	}

	render(){
		return(
<form onSubmit={this.handleSubmit}>
	ç”¨æˆ·åï¼š<input onChange={this.saveUsername} type="text" name="username"/>
	å¯†ç ï¼š<input onChange={this.savePassword} type="password" name="password"/>
	<button>ç™»å½•</button>
</form>ä¸     
		)
	}
}
//æ¸²æŸ“ç»„ä»¶
ReactDOM.render(<Login/>,document.getElementById('test'))
```



## 3.3 é«˜é˜¶å‡½æ•° å’Œ æŸ¯é‡ŒåŒ–

### 1 é«˜é˜¶å‡½æ•°ï¼š

è§£å†³åœ¨äº‹ä»¶å›è°ƒå‡½æ•°ä¸­ï¼Œä¸èƒ½ä¼ é€’å‚æ•°çš„é—®é¢˜ã€‚å› ä¸ºå›è°ƒå‡½æ•°åº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°åœ°å€ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯ `func`ï¼Œè€Œä¸æ˜¯ `func()`ã€‚

é«˜é˜¶å‡½æ•°ï¼šå¦‚æœä¸€ä¸ªå‡½æ•°ç¬¦åˆä¸‹é¢2ä¸ªè§„èŒƒä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œé‚£è¯¥å‡½æ•°å°±æ˜¯é«˜é˜¶å‡½æ•°ã€‚

1. è‹¥Aå‡½æ•°ï¼Œæ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆAå°±å¯ä»¥ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°ã€‚
2. è‹¥Aå‡½æ•°ï¼Œè°ƒç”¨çš„è¿”å›å€¼ä¾ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆAå°±å¯ä»¥ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°ã€‚

å¸¸è§çš„é«˜é˜¶å‡½æ•°æœ‰ï¼š`Promise`ã€`setTimeout`ã€`arr.map()` ç­‰ç­‰

ä¸€ä¸ªéœ€è¦é«˜é˜¶å‡½æ•°åº”ç”¨çš„åœºæ™¯å°±æ˜¯ï¼šä¸ºäº†æé«˜æ•ˆç‡ï¼Œæƒ³è®©å¤šä¸ªèŠ‚ç‚¹çš„äº‹ä»¶è§¦å‘éƒ½è°ƒç”¨åŒä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚ä¸ºäº†è®©å›è°ƒå‡½æ•°åŒºåˆ†ç©¶ç«Ÿæ˜¯å“ªä¸€ä¸ªèŠ‚ç‚¹è§¦å‘çš„å›è°ƒï¼Œæ­¤æ—¶éœ€è¦åœ¨èŠ‚ç‚¹ç»‘å®šå›è°ƒå‡½æ•°çš„æ—¶å€™ï¼Œä¼ é€’ä¸€ä¸ªè¯†åˆ«è‡ªèº«çš„å‚æ•°ï¼Œè¿™æ—¶å°±éœ€è¦é«˜é˜¶å‡½æ•°å‡ºé©¬äº†ï¼š

```jsx
//åˆ›å»ºç»„ä»¶
class Login extends React.Component{
    //åˆå§‹åŒ–çŠ¶æ€
    state = {
        username:'', //ç”¨æˆ·å
        password:'' //å¯†ç 
    }

//ä¿å­˜è¡¨å•æ•°æ®åˆ°çŠ¶æ€ä¸­ã€‚
//è°ƒç”¨è¯¥å‡½æ•°ï¼Œè¿”å›çœŸæ­£çš„å›è°ƒå‡½æ•°ã€‚å½¢æˆäº†ä¸€ä¸ªé—­åŒ…ï¼Œä¿å­˜äº†ä¼ é€’è¿‡æ¥çš„ 'username'æˆ–'password'å‚æ•°ï¼Œç”¨æ¥è¯†åˆ«ç©¶ç«Ÿæ˜¯è°è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚
saveFormData = (dataType)=>{
    return (event)=>{
        this.setState({[dataType]:event.target.value})
    }
}

//è¡¨å•æäº¤çš„å›è°ƒ
handleSubmit = (event)=>{
    event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
    const {username,password} = this.state
    alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
}
render(){
    return(
<form onSubmit={this.handleSubmit}>
	ç”¨æˆ·åï¼š<input onChange={this.saveFormData('username')} type="text" name="username"/>
	å¯†ç ï¼š<input onChange={this.saveFormData('password')} type="password" name="password"/>
	<button>ç™»å½•</button>
</form>
    )
}
}
//æ¸²æŸ“ç»„ä»¶
ReactDOM.render(<Login/>,document.getElementById('test'))
```



### 2 å‡½æ•°çš„æŸ¯é‡ŒåŒ–

é€šè¿‡å‡½æ•°è°ƒç”¨ç»§ç»­è¿”å›å‡½æ•°çš„æ–¹å¼ï¼Œå®ç°å¤šæ¬¡æ¥æ”¶å‚æ•°æœ€åç»Ÿä¸€å¤„ç†çš„å‡½æ•°ç¼–ç å½¢å¼ã€‚ 

```js
function sum(a){
    return(b)=>{
        return (c)=>{
            return a+b+c
        }
    }
}
```

ä¸Šæ–‡ä¸­ï¼Œå¤„ç†å›è°ƒå‡½æ•°çš„æ–¹æ³•ä¹Ÿæ˜¯ä¸€ç§æŸ¯é‡ŒåŒ–ï¼š

åœ¨æ”¶åˆ°å‚æ•°åï¼Œé€šè¿‡å‡½æ•°çš„å±‚å±‚åµŒå¥—ï¼Œåœ¨æœ€å `return` çš„æ—¶å€™ç»Ÿä¸€å¤„ç†ã€‚

```js
saveFormData = (dataType)=>{
    return (event)=>{
        this.setState({[dataType]:event.target.value})
    }
}
```



å¦‚æœä¸ä½¿ç”¨æŸ¯é‡ŒåŒ–ï¼š

```jsx
class Login extends React.Component{
    //åˆå§‹åŒ–çŠ¶æ€
    state = {
        username:'', //ç”¨æˆ·å
        password:'' //å¯†ç 
    }

//ä¿å­˜è¡¨å•æ•°æ®åˆ°çŠ¶æ€ä¸­
saveFormData = (dataType,event)=>{
    this.setState({[dataType]:event.target.value})
}

//è¡¨å•æäº¤çš„å›è°ƒ
handleSubmit = (event)=>{
    event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
    const {username,password} = this.state
    alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
}
	render(){
 	   return(
<form onSubmit={this.handleSubmit}>
    ç”¨æˆ·åï¼š<input onChange={event => this.saveFormData('username',event) } type="text" name="username"/>
    å¯†ç ï¼š<input onChange={event => this.saveFormData('password',event) } type="password" name="password"/>
    <button>ç™»å½•</button>
</form>
 	   )
	}
}
//æ¸²æŸ“ç»„ä»¶
ReactDOM.render(<Login/>,document.getElementById('test'))
```



# 4 ç”Ÿå‘½å‘¨æœŸ

## 4.1 react ç”Ÿå‘½å‘¨æœŸï¼ˆæ—§ï¼‰:

![reactç”Ÿå‘½å‘¨æœŸ(æ—§)](%E6%88%91%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%9C%8B%E7%9A%84%E7%AC%94%E8%AE%B0/react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E6%97%A7).png)

å¸¸ç”¨çš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆ**å›¾ä¸­ç»¿è‰²çš„**ï¼‰ï¼š

- `componentDidMount()`
  - ç»„ä»¶æŒ‚è½½å®Œæ¯•ã€‚
  - ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›åˆå§‹åŒ–çš„äº‹ï¼Œä¾‹å¦‚ï¼šå¼€å¯å®šæ—¶å™¨ã€å‘é€ç½‘ç»œè¯·æ±‚ã€è®¢é˜…æ¶ˆæ¯
- `componentWillUnmount()`
  - ç»„ä»¶å°†è¦å¸è½½ã€‚
  - ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›æ”¶å°¾çš„äº‹ï¼Œä¾‹å¦‚ï¼šå…³é—­å®šæ—¶å™¨ã€å–æ¶ˆè®¢é˜…æ¶ˆæ¯
- `render()`
  - åªè¦æ›´æ–°é¡µé¢ã€å°±ä¼šæœ‰ `render()` çš„è°ƒç”¨ã€‚



### 1 åˆå§‹åŒ–é˜¶æ®µï¼š

ç”± `ReactDOM.render()` è§¦å‘ ------> **åˆæ¬¡æ¸²æŸ“**

1. `constructor()`ï¼Œå°±æ˜¯ç±»ä¸­å®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œç»å¸¸ä¼šè¢«çœç•¥ã€‚
2. `componentWillMount()`ï¼Œç»„ä»¶å°†è¦æŒ‚è½½ã€‚
3. `render()`ï¼Œæ¸²æŸ“é¡µé¢ã€‚
4. `componentDidMount()` ï¼Œç»„ä»¶æŒ‚è½½å®Œæ¯•ã€‚=====> **å¸¸ç”¨**



### 2 æ›´æ–°é˜¶æ®µï¼š

æ ¹æ®è§¦å‘æ¡ä»¶çš„ä¸åŒï¼Œç»„ä»¶æ›´æ–°æœ‰ä¸‰ç§æƒ…å†µï¼š

1. æœ€å¸¸è§ï¼Œé€šè¿‡ç»„ä»¶å†…éƒ¨çš„ `this.setState()` è§¦å‘ç»„ä»¶æ›´æ–°ï¼›
2. é€šè¿‡è°ƒç”¨ `forceUpdate()` å¼ºåˆ¶ç»„ä»¶æ›´æ–°ï¼Œä½¿ç”¨çš„è¾ƒå°‘ï¼Œæ¯”å¦‚æ²¡æœ‰æ›´æ”¹ä»»ä½•ç»„ä»¶ä¸­çŠ¶æ€çš„æ•°æ®ï¼Œå¼ºåˆ¶æ›´æ–°ä¸€æ¬¡æ—¶ä½¿ç”¨ã€‚
3. å½“çˆ¶ç»„ä»¶è°ƒç”¨ `render()` æ—¶ï¼Œä¼šè§¦å‘å­ç»„ä»¶çš„æ›´æ–°ï¼Œå…¶ä¸­æœ‰å¯èƒ½ä¼šäº§ç”Ÿçˆ¶å­ç»„ä»¶é—´çš„é€šä¿¡ï¼›



æƒ…å†µä¸€ï¼šé€šè¿‡å†…éƒ¨çš„ `this.setState()` æ›´æ–°ç»„ä»¶ï¼š

1. `shouldComponentUpdate()`ï¼Œç»„ä»¶æ˜¯å¦åº”è¯¥è¢«æ›´æ–°ï¼Œæ˜¯ä¸€ä¸ª **â€œé—¨é—©â€**ã€‚
   - å¦‚æœè¿™ä¸ªå‡½æ•°è¿”å› `true`ï¼Œç»„ä»¶å¯ä»¥æ­£å¸¸è¢«æ›´æ–°ï¼›
   - å¦‚æœè¿™ä¸ªå‡½æ•°è¿”å› `false`ï¼Œç»„ä»¶ä¼šè¢«é˜»æ­¢æ›´æ–°ï¼Œåœæ­¢æ¥ä¸‹æ¥çš„æµç¨‹ã€‚
2. `componentWillUpdate()`ï¼Œç»„ä»¶å°†è¦æ›´æ–°ã€‚
3. `render()`   =====>   **ä¸€å®šä¼šè°ƒç”¨**
4. `componentDidUpdate(preProps, preState)` ç»„ä»¶æ›´æ–°å®Œæ¯•ã€‚
   - `preProps`ï¼šæ›´æ–°ä¹‹å‰çš„ propsï¼›
   - `preState`ï¼šæ›´æ–°ä¹‹å‰çš„ stateã€‚



æƒ…å†µäºŒï¼šé€šè¿‡è°ƒç”¨ `forceUpdate()` å¼ºåˆ¶ç»„ä»¶æ›´æ–°ï¼Œæ²¡æœ‰æ­£å¸¸æ›´æ–°æµç¨‹ä¸­çš„ **â€œé—¨é—©â€**ï¼š

1. `componentWillUpdate()`ï¼Œç»„ä»¶å°†è¦æ›´æ–°ã€‚
2. `render()`   =====>   **ä¸€å®šä¼šè°ƒç”¨**
3. `componentDidUpdate(preProps, preState)` ç»„ä»¶æ›´æ–°å®Œæ¯•ã€‚
   - `preProps`ï¼šæ›´æ–°ä¹‹å‰çš„ propsï¼›
   - `preState`ï¼šæ›´æ–°ä¹‹å‰çš„ stateã€‚



æƒ…å†µä¸‰ï¼šå½“çˆ¶ç»„ä»¶è°ƒç”¨ `render()` æ—¶ï¼Œå­ç»„ä»¶ä¹Ÿè¦æ›´æ–°ï¼š

1. `componentwillReceiveProps(props)`ï¼Œç»„ä»¶å°†è¦æ¥æ”¶ï¼ˆçˆ¶ç»„ä»¶ä¼ é€’çš„ ï¼‰props å‚æ•°ã€‚
   - **æ³¨æ„ï¼ï¼ï¼Œç¬¬ä¸€æ¬¡ä¼ é€’ props æ—¶ï¼Œä¸ä¼šè§¦å‘è¯¥å‡½æ•°è°ƒç”¨**ï¼›
   - åœ¨çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’ **æ–°çš„** props æ—¶æ‰ä¼šè°ƒç”¨ã€‚
   - å¯ä»¥æºå¸¦å‚æ•°ï¼Œå‚æ•°å°±æ˜¯ä¼ é€’çš„ propsã€‚
2. `shouldComponentUpdate()`ï¼Œç»„ä»¶æ˜¯å¦åº”è¯¥è¢«æ›´æ–°ï¼Œæ˜¯ä¸€ä¸ª **â€œé—¨é—©â€**ã€‚
   - å¦‚æœè¿™ä¸ªå‡½æ•°è¿”å› `true`ï¼Œç»„ä»¶å¯ä»¥æ­£å¸¸è¢«æ›´æ–°ï¼›
   - å¦‚æœè¿™ä¸ªå‡½æ•°è¿”å› `false`ï¼Œç»„ä»¶ä¼šè¢«é˜»æ­¢æ›´æ–°ï¼Œåœæ­¢æ¥ä¸‹æ¥çš„æµç¨‹ã€‚
3. `componentWillUpdate(preProps, preState)`ï¼Œç»„ä»¶å°†è¦æ›´æ–°ã€‚
4. `render()`   =====>   **ä¸€å®šä¼šè°ƒç”¨**
5. `componentDidUpdate(preProps, preState)` ç»„ä»¶æ›´æ–°å®Œæ¯•ã€‚
   - `preProps`ï¼šæ›´æ–°ä¹‹å‰çš„ propsï¼›
   - `preState`ï¼šæ›´æ–°ä¹‹å‰çš„ stateã€‚



### 3 å¸è½½ç»„ä»¶ï¼š

ç”± `ReactDOM.unmountComponentAtNode()` è§¦å‘

1. `componentWillUnmount()` =====> **å¸¸ç”¨**ï¼Œç»„ä»¶å°†è¦å¸è½½ã€‚
   - ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›æ”¶å°¾çš„äº‹ï¼Œä¾‹å¦‚ï¼šå…³é—­å®šæ—¶å™¨ã€å–æ¶ˆè®¢é˜…æ¶ˆæ¯



## 4.2 react ç”Ÿå‘½å‘¨æœŸï¼ˆæ—§ï¼‰:

react ç”Ÿå‘½å‘¨æœŸï¼ˆæ–°ï¼‰

![reactç”Ÿå‘½å‘¨æœŸ(æ–°)](%E6%88%91%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%9C%8B%E7%9A%84%E7%AC%94%E8%AE%B0/react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F(%E6%96%B0).png)

ä¸æ—§ç”Ÿå‘½å‘¨æœŸçš„å¯¹æ¯”ï¼š

å°‘äº† 3 ä¸ªå‡½æ•°ï¼š

- `componentWillMount()`ï¼Œç»„ä»¶å³å°†æŒ‚è½½ã€‚
- `componentWillReceiveProps()`ï¼Œç»„ä»¶æ¥æ”¶çˆ¶ç»„ä»¶æ–°çš„ propsã€‚
- `componentWillUpdate()`ï¼Œç»„é¢å³å°†æ›´æ–°ã€‚

å¤šäº† 2 ä¸ªå‡½æ•°ï¼š

- `getDerivedStateFromProps()`
- `getSnapshotBeforeUpdate()`



è¿™ä¸¤ä¸ªå‡½æ•°çš„ä½¿ç”¨åœºæ™¯éå¸¸ç½•è§ï¼Œæ›´å¤šçš„æ˜¯ä¸‹é¢ä¸‰ä¸ªï¼ˆå’Œæ—§ç”Ÿå‘½å‘¨æœŸä¸€æ ·ï¼‰ï¼Œå›¾ä¸­ç»¿è‰²çš„å‡½æ•°ï¼š

- `componentDidMount()`
  - ç»„ä»¶æŒ‚è½½å®Œæ¯•ã€‚
  - ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›åˆå§‹åŒ–çš„äº‹ï¼Œä¾‹å¦‚ï¼šå¼€å¯å®šæ—¶å™¨ã€å‘é€ç½‘ç»œè¯·æ±‚ã€è®¢é˜…æ¶ˆæ¯
- `componentWillUnmount()`
  - ç»„ä»¶å°†è¦å¸è½½ã€‚
  - ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›æ”¶å°¾çš„äº‹ï¼Œä¾‹å¦‚ï¼šå…³é—­å®šæ—¶å™¨ã€å–æ¶ˆè®¢é˜…æ¶ˆæ¯
- `render()`
  - åªè¦æ›´æ–°é¡µé¢ã€å°±ä¼šæœ‰ `render()` çš„è°ƒç”¨ã€‚



### 1 ç»„ä»¶æŒ‚è½½æ—¶ï¼š

1. `consructor()`ï¼Œè°ƒç”¨ç»„ä»¶çš„æ„é€ å‡½æ•°ã€‚

2. `static getDerivedStateFromProps(props, state)`ï¼Œä» props ä¸­å¾—åˆ°ä¸€ä¸ªæ´¾ç”Ÿçš„ stateã€‚æ¢å¥è¯è¯´ï¼Œç»„ä»¶å¯ä»¥é€šè¿‡ä¼ é€’è¿‡æ¥çš„ propsï¼Œå»ä¿®æ”¹ç»„ä»¶ä¸­çš„ stateã€‚

   - å¿…é¡»æ·»åŠ ä¸ºä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ·»åŠ åœ¨ç±»çš„åŸå‹ä¸­ã€‚

   - è¯¥æ–¹æ³•åº”è¯¥è¿”å›ä¸€ä¸ªçŠ¶æ€ state å¯¹è±¡ï¼Œæˆ–è€… `null`ã€‚

   - è¯¥æ–¹æ³•å¯ä»¥æ·»åŠ å‚æ•° props å’Œ stateã€‚

     - **æ­¤æ–¹æ³•é€‚ç”¨äºä¸€ä¸ªç½•è§çš„ç”¨ä¾‹ï¼Œå³ state  çš„å€¼åœ¨ä»»ä½•æ—¶å€™éƒ½å–å†³äº propsã€‚**

     - `props` ä¼ é€’çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢ä¿å­˜äº† `K/V` å¯¹ã€‚å¯ä»¥ç›´æ¥è¿”å›å¹¶æŠŠ `state` æ›´æ–°ã€‚

       ```jsx
       static getDerivedStateFromProps(props, state) {
           console.log('getDerivedStateFromProps', props, state)
           return props
       }
       ```

3. `render()`ï¼Œæ¸²æŸ“é¡µé¢ã€‚

4. `componentDidUpdate(preProps, preState, snapshotValue)` ç»„ä»¶æ›´æ–°å®Œæ¯•ã€‚

   - `preProps`ï¼šæ›´æ–°ä¹‹å‰çš„ propsï¼›
   - `preState`ï¼šæ›´æ–°ä¹‹å‰çš„ stateï¼›
   - `snapshotValue`ï¼š`getSnapshotBeforeUpdate()`  å¿«ç…§å‡½æ•°çš„è¿”å›å€¼ã€‚



### 2 ç»„ä»¶æ›´æ–°æ—¶ï¼š

å½“æœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š

- ä¼ é€’æ–° propsï¼ˆæ¯”å¦‚çˆ¶å­ç»„ä»¶é—´é€šä¿¡ï¼‰ã€
- æ‰§è¡Œ `setState()`ã€ 
- æ‰§è¡Œ `forceUpdate()` å¼ºåˆ¶æ›´æ–°æ—¶ï¼›

1. `static getDerivedStateFromProps(props, state)` ï¼Œä» props ä¸­å¾—åˆ°ä¸€ä¸ªæ´¾ç”Ÿçš„ stateã€‚è¯¦ç»†ä¿¡æ¯è§ä¸Šé¢ğŸ‘†ã€‚

2. `shouldComponentUpdate()` ï¼Œä¸€ä¸ªé—¨é—©ï¼Œç¡®å®šæ˜¯å¦è¦æ›´æ–°ã€‚

3. `render()`ï¼Œè°ƒç”¨æ¸²æŸ“ç¨‹åºï¼Œä½†æ˜¯è¿˜æ²¡æ›´æ–° React çš„ DOMã€‚

4. `getSnapshotBeforeUpdate()` ï¼Œåœ¨ç»„ä»¶ä» DOM ä¸­æ•è·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œæ»šåŠ¨ä½ç½®ï¼‰ã€‚

   - æ­¤ç”Ÿå‘½å‘¨æœŸçš„ä»»ä½•è¿”å›å€¼å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™ `componentDidUpdate()`ã€‚

   - **å¿…é¡»è¦è¿”å›ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼ˆä¸€ä¸ªå¿«ç…§å€¼ï¼‰ï¼Œæˆ–è€… `null`ï¼›**

5. `componentDidUpdate(preProps, preState, snapshotValue)` ç»„ä»¶æ›´æ–°å®Œæ¯•ã€‚

   - `preProps`ï¼šæ›´æ–°ä¹‹å‰çš„ propsï¼›
   - `preState`ï¼šæ›´æ–°ä¹‹å‰çš„ stateï¼›
   - `snapshotValue`ï¼š`getSnapshotBeforeUpdate()`  å¿«ç…§å‡½æ•°çš„è¿”å›å€¼ã€‚



### 3 å¸è½½ç»„ä»¶ï¼š

ç”± `ReactDOM.unmountComponentAtNode()` è§¦å‘

1. `componentWillUnmount()` =====> **å¸¸ç”¨**ï¼Œç»„ä»¶å°†è¦å¸è½½ã€‚
   - ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›æ”¶å°¾çš„äº‹ï¼Œä¾‹å¦‚ï¼šå…³é—­å®šæ—¶å™¨ã€å–æ¶ˆè®¢é˜…æ¶ˆæ¯ã€‚





# 5 DOMçš„Diffingç®—æ³•

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](%E6%88%91%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%9C%8B%E7%9A%84%E7%AC%94%E8%AE%B0/96b5367055a04b8fbbb1e11363883f31tplv-k3u1fbpfcp-watermark.awebp)

ä¼šä¸€å±‚ä¸€å±‚çš„åˆ†æå’Œå¯¹æ¯”ï¼Œåªè¦æŸä¸ªèŠ‚ç‚¹çš„å†…éƒ¨è¿˜æœ‰åµŒå¥—çš„èŠ‚ç‚¹ï¼Œå°±ä¼šä¸€å±‚ä¸€å±‚çš„å¾€ä¸‹å¯¹æ¯”ã€‚



## 5.2 å…³äºkeyçš„ç»å…¸é¢è¯•é¢˜

1. react/vueä¸­çš„keyæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿï¼ˆkeyçš„å†…éƒ¨åŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼‰
2. ä¸ºä»€ä¹ˆéå†åˆ—è¡¨æ—¶ï¼Œkeyæœ€å¥½ä¸è¦ç”¨index?

### 5.2.11 è™šæ‹ŸDOMä¸­keyçš„ä½œç”¨

- ç®€å•çš„è¯´: keyæ˜¯è™šæ‹ŸDOMå¯¹è±¡çš„æ ‡è¯†, åœ¨æ›´æ–°æ˜¾ç¤ºæ—¶keyèµ·ç€æå…¶é‡è¦çš„ä½œç”¨ã€‚
- è¯¦ç»†çš„è¯´: å½“çŠ¶æ€ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œreactä¼šæ ¹æ®ã€æ–°æ•°æ®ã€‘ç”Ÿæˆã€æ–°çš„è™šæ‹ŸDOMã€‘, éšåReactè¿›è¡Œã€æ–°è™šæ‹ŸDOMã€‘ä¸ã€æ—§è™šæ‹ŸDOMã€‘çš„diffæ¯”è¾ƒï¼Œæ¯”è¾ƒè§„åˆ™å¦‚ä¸‹ï¼š
  - æ—§è™šæ‹ŸDOMä¸­æ‰¾åˆ°äº†ä¸æ–°è™šæ‹ŸDOMç›¸åŒçš„keyï¼š
    - è‹¥è™šæ‹ŸDOMä¸­å†…å®¹æ²¡å˜, ç›´æ¥ä½¿ç”¨ä¹‹å‰çš„çœŸå®DOM
    - è‹¥è™šæ‹ŸDOMä¸­å†…å®¹å˜äº†, åˆ™ç”Ÿæˆæ–°çš„çœŸå®DOMï¼Œéšåæ›¿æ¢æ‰é¡µé¢ä¸­ä¹‹å‰çš„çœŸå®DOM
  - æ—§è™šæ‹ŸDOMä¸­æœªæ‰¾åˆ°ä¸æ–°è™šæ‹ŸDOMç›¸åŒçš„key
    - æ ¹æ®æ•°æ®åˆ›å»ºæ–°çš„çœŸå®DOMï¼Œéšåæ¸²æŸ“åˆ°åˆ°é¡µé¢

### 5.2.2 ç”¨ index ä½œä¸º key å¯èƒ½ä¼šå¼•å‘çš„é—®é¢˜

**æƒ…å†µ1ï¼š**

è‹¥å¯¹æ•°æ®è¿›è¡Œï¼š**é€†åºæ·»åŠ ã€é€†åºåˆ é™¤ç­‰ç ´åé¡ºåºæ“ä½œ**ï¼Œå°±ä¼šå¯¼è‡´äº§ç”Ÿæ²¡æœ‰å¿…è¦çš„çœŸå® DOM æ›´æ–°ã€‚

è¿™æ˜¯å› ä¸ºå¦‚æœç ´åäº†é¡ºåºï¼Œè™½ç„¶æ–°æ—§è™šæ‹Ÿ DOM ä¸­æ‹¥æœ‰ç›¸åŒ index åç§°çš„èŠ‚ç‚¹ï¼Œä½†æ˜¯å…¶å†…å®¹å› ä¸ºé¡ºè®¯è¢«ç ´åäº†å…³ç³»ï¼Œå·²ç»å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œè¿™å¯¼è‡´æ‰€æœ‰å†…å®¹éœ€è¦å…¨éƒ¨é‡æ–°æ¸²æŸ“ã€‚

- æœ€ç»ˆç»“æœï¼šç•Œé¢æ•ˆæœæ²¡é—®é¢˜, ä½†æ•ˆç‡ä½ã€‚



**æƒ…å†µ2ï¼š**

å¦‚æœç»“æ„ä¸­è¿˜åŒ…å«è¾“å…¥ç±»çš„ DOMï¼šä¼šäº§ç”Ÿé”™è¯¯ DOM æ›´æ–°ã€‚

- æœ€ç»ˆç»“æœï¼šç•Œé¢ä¼šå‘ç”Ÿé—®é¢˜ã€‚



æ¯”å¦‚ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ï¼Œå¦‚æœåœ¨è¿™åˆ—ä¿¡æ¯çš„å¼€å¤´ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„ä¿¡æ¯ã€‚åœ¨åˆ—è¡¨çš„ index ä½¿ç”¨äº†é»˜è®¤ç´¢å¼•å€¼ä½œä¸º keyã€‚åœ¨åˆæ¬¡æ¸²æŸ“åï¼Œæ·»åŠ äº†æ–°é¡¹ç›® â€œå°ç‹â€ã€‚

1. `Diffing` ç®—æ³•é€šè¿‡å¯¹æ¯”ï¼Œå‘ç°ç¬¬ä¸€è¡Œè™½ç„¶ key éƒ½ä¸º `0`ï¼Œåœ¨ `text` æ–‡æœ¬å·²ç»ä¸å¯¹ï¼Œæ‰€ä»¥æ–‡æœ¬å†…å®¹ `å°å¼ --18` ä¼šé‡æ–°æ¸²æŸ“ã€‚
2. ç„¶å `Diffing` ç®—æ³•å‘ç°ä¸€ä¸ª li æ ‡ç­¾å†…éƒ¨è¿˜æœ‰ä¸€ä¸ª `input` ç”¨æˆ·è¾“å…¥æ¡†ï¼Œæ‰€ä»¥è¿›è¡Œç¬¬äºŒæ¬¡å¯¹æ¯”ã€‚é€šè¿‡æ¯”è¾ƒ `<input type="text">` å‘ç°ä¸¤è€…å®Œå…¨ç›¸åŒï¼Œæ‰€ä»¥æ–°æ—§è™šæ‹Ÿ DOM æ²¡æœ‰å‘ç”Ÿæ›´æ–°ã€‚
3. ä½†æ˜¯ï¼Œåœ¨è™šæ‹Ÿ DOM æœ€ç»ˆæ¸²æŸ“ä¸ºçœŸå® DOM çš„æ—¶å€™ï¼Œå› ä¸ºç”¨æˆ·è¾“å…¥çš„å€¼ä¸åŒï¼ˆè¡¨ç°åœ¨ input èŠ‚ç‚¹çš„  `.value` å±æ€§ ï¼‰ï¼Œå°±ä¼šå‘ç”Ÿé”™ä½ç°è±¡ã€‚

- åªæœ‰çœŸå® DOMï¼Œæ‘†åœ¨äº†é¡µé¢ä¸Šï¼Œæ‰ä¼šæœ‰ç”¨æˆ·è¾“å…¥ï¼Œæ‰ä¼šæœ‰ `.value` å€¼ã€‚è™šæ‹Ÿ DOM çš„å±æ€§éå¸¸å°‘ï¼Œä¹Ÿæ²¡æœ‰ `value` å±æ€§ã€‚

```jsx
// æ›´æ–°å‰çš„æ•°æ®ï¼š
<li key=0>å°å¼ --18<input type="text" /></li>
<li key=1>å°é‡Œ--19<input type="text" /></li>

// æ›´æ–°åçš„æ•°æ®ï¼š
<li key=0>å°ç‹--20<input type="text" /></li>
<li key=1>å°å¼ --18<input type="text" /></li>
<li key=2>å°é‡Œ--19<input type="text" /></li>
```

ä¸‹å›¾æ˜¯ä½¿ç”¨ ç´¢å¼•å€¼ å’Œä½¿ç”¨ æ•°æ®çš„å”¯ä¸€æ ‡è¯†ï¼Œåœ¨æ›´æ–°å°ç‹æ—¶å‰åçš„ä¸åŒæ•ˆæœã€‚

å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä½¿ç”¨ç´¢å¼•å€¼ï¼Œå°±ä¼šå‘ç”Ÿ `text` æ–‡æœ¬æ­£ç¡®æ›´æ–°ï¼Œä½†æ˜¯ `input` æ ‡ç­¾æ²¡æœ‰æ›´æ–°çš„é—®é¢˜ï¼Œè¿™ç»¥ä¸­å¯¼è‡´äº† `input` æ ‡ç­¾çš„ç°å®é”™ä½ã€‚``

 ![image-20211011222739017](%E6%88%91%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%9C%8B%E7%9A%84%E7%AC%94%E8%AE%B0/image-20211011222739017.png)  ![image-20211011222759090](%E6%88%91%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%9C%8B%E7%9A%84%E7%AC%94%E8%AE%B0/image-20211011222759090.png)

**æ³¨æ„ï¼** å¦‚æœä¸å­˜åœ¨å¯¹æ•°æ®çš„é€†åºæ·»åŠ ã€é€†åºåˆ é™¤ç­‰ç ´åé¡ºåºæ“ä½œï¼Œä»…ç”¨äºæ¸²æŸ“åˆ—è¡¨ç”¨äºå±•ç¤ºï¼Œä½¿ç”¨ index ä½œä¸º key æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚



### 5.2.3 å¼€å‘ä¸­å¦‚ä½•é€‰æ‹© key?

1. æœ€å¥½ä½¿ç”¨æ¯æ¡æ•°æ®çš„å”¯ä¸€æ ‡è¯†ä½œä¸º keyï¼Œæ¯”å¦‚ idã€æ‰‹æœºå·ã€èº«ä»½è¯å·ã€å­¦å·ç­‰å”¯ä¸€å€¼ï¼›
2. å¦‚æœç¡®å®šåªæ˜¯ç®€å•çš„å±•ç¤ºæ•°æ®ï¼Œç”¨ index ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

è¿™ç§ç°è±¡ä¹Ÿä½è¯äº†ä¸ºä»€ä¹ˆæ•°æ®åº“ï¼Œä¸€å®šè¦æœ‰ **ä¸»é”®** çš„åŸå› ä¹‹ä¸€ã€‚

å¦‚æœå®åœ¨æ²¡æœ‰å¯ä»¥å”¯ä¸€æ ‡è¯†çš„é€‰é¡¹ï¼Œå¯ä»¥ä¸¤ä¸ªå±æ€§åŠ èµ·æ¥ï¼Œæ¯”å¦‚ `name + phoneNumber`ã€‚



# [äºŒ] React è„šæ‰‹æ¶

# 1 åˆå§‹åŒ–è„šæ‰‹æ¶

## 1.1 å¯åŠ¨é¡¹ç›®

### 1.1.1 åˆ›å»ºé¡¹ç›®å¹¶å¯åŠ¨

1. å…¨å±€å®‰è£…ï¼š`npm i -g create-react-app`
2. åˆ‡æ¢åˆ°æƒ³åˆ›å»ºé¡¹ç›®çš„ç›®å½•,ä½¿ç”¨å‘½ä»¤ï¼š`create-react-arr hello-react`
3. è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹
4. å¯åŠ¨é¡¹ç›®ï¼š`npm start`

### 1.1.2 react è„šæ‰‹æ¶é¡¹ç›®ç»“æ„

public ---- é™æ€èµ„æºæ–‡ä»¶å¤¹

â€‹			favicon.icon ------ ç½‘ç«™é¡µç­¾å›¾æ ‡

â€‹            **index.html --------** **ä¸»é¡µé¢**ï¼Œé¡¹ç›®åªæœ‰ä¸€ä¸ª `.html` æ–‡ä»¶ï¼ŒSPAï¼ˆsingle page appï¼‰å•é¡µé¢åº”ç”¨ã€‚

â€‹            logo192.png ------- logoå›¾

â€‹            logo512.png ------- logoå›¾

â€‹            manifest.json ----- åº”ç”¨åŠ å£³çš„é…ç½®æ–‡ä»¶

â€‹            robots.txt -------- çˆ¬è™«åè®®æ–‡ä»¶

src ---- æºç æ–‡ä»¶å¤¹

â€‹            App.css -------- App ç»„ä»¶çš„æ ·å¼

â€‹            **App.js --------- App ç»„ä»¶**ï¼Œé¡¹ç›®åªæœ‰ä¸€ä¸ªçˆ¶ç»„ä»¶ï¼Œæ”¾åˆ° `<div id="root"></div>` ä¸­ï¼Œå…¶ä½™è‡ªå·±æ·»åŠ çš„ç»„ä»¶ï¼Œéƒ½æ”¾åˆ° App ç»„ä»¶ä¸­ã€‚ ã€

â€‹            App.test.js ---- ç”¨äºç»™ App åšæµ‹è¯•

â€‹            index.css ------ é¡¹ç›®çš„é€šç”¨æ ·å¼

â€‹            **index.js -------** **å…¥å£æ–‡ä»¶**

â€‹            logo.svg ------- logo å›¾

â€‹            reportWebVitals.js 	------- é¡µé¢æ€§èƒ½åˆ†ææ–‡ä»¶ (éœ€è¦ web-vitals åº“çš„æ”¯æŒ)

â€‹            setupTests.js 			  ------- ç»„ä»¶å•å…ƒæµ‹è¯•çš„æ–‡ä»¶ (éœ€è¦ jest-dom åº“çš„æ”¯æŒ)

### 1.1.3 index.html

é»˜è®¤çš„ index.html å¦‚ä¸‹ï¼š

```html
<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8" />
      <!-- %PUBLIC_URL%ä»£è¡¨publicæ–‡ä»¶å¤¹çš„è·¯å¾„ -->
      <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
      <!-- å¼€å¯ç†æƒ³è§†å£ï¼Œç”¨äºåšç§»åŠ¨ç«¯ç½‘é¡µçš„é€‚é… -->
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <!-- ç”¨äºé…ç½®æµè§ˆå™¨é¡µç­¾+åœ°å€æ çš„é¢œè‰²(ä»…æ”¯æŒandroidæµè§ˆå™¨) -->
      <meta name="theme-color" content="red" />
      <meta
            name="description"
            content="Web site created using create-react-app"
      />
      <!-- ç”¨äºæŒ‡å®šç½‘é¡µæ·»åŠ åˆ°æ‰‹æœºä¸»å±å¹•åçš„å›¾æ ‡(ä»…æ”¯æŒiosæµè§ˆå™¨)  -->
      <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
      <!-- åº”ç”¨åŠ å£³æ—¶çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ç»™htmlåŠ å£³ä¸ºandroidæˆ–iosåº”ç”¨ -->
      <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
      <title>React App</title>
  </head>
  <body>
	<!-- è‹¥llqä¸æ”¯æŒjsåˆ™å±•ç¤ºæ ‡ç­¾ä¸­çš„å†…å®¹ -->
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
```

æœ€ç»ˆç¼©å‡çš„ index.html å¦‚ä¸‹ï¼š

```html
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>reactè„šæ‰‹æ¶</title>
		<link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
		<link rel="stylesheet" href="/css/bootstrap.css">
		<style>
			.atguigu{
				background-color: rgb(209, 137, 4) !important;
				color: white !important;
			}
		</style>
	</head>
	<body>
		<div id="root"></div>
	</body>
</html>
```

- åœ¨åœ°å€ä¸­ `href="%PUBLIC_URL%/favicon.ico"`  ï¼Œä½¿ç”¨ `%PUBLIC_URL%` çš„å‰åç™¾åˆ†å·é”å®šæ–‡ä»¶å¤¹æ˜¯ `public`ã€‚åœ¨è·¯ç”±ä¸­ï¼Œç›¸æ¯”ä½¿ç”¨  `./favicon.ico`çš„å½¢å¼ï¼Œç™¾åˆ†å·ä¸ä¼šäº§ç”Ÿåœ°å€é”™è¯¯ã€‚



### 1.1.5 index.js

å…¥å£æ–‡ä»¶ï¼Œå¼•å…¥ react æ ¸å¿ƒåº“ã€react-dom æ ¸å¿ƒåº“ã€App ç»„ä»¶ç­‰å¿…è¦çš„èµ„æºï¼š

```js
import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './App';
import reportWebVitals from './reportWebVitals';

ReactDOM.render(
  <React.StrictMode> 
    <App />
  </React.StrictMode>,
  document.getElementById('root')
);

reportWebVitals();
```

- `<React.StrictMode> `ï¼šå¯ä»¥æ£€æµ‹ React å†…çš„ç»„ä»¶æ˜¯å¦ç¼–å†™åˆç†ï¼›
- `reportWebVitals`ï¼šé¡µé¢æ€§èƒ½æµ‹è¯•ï¼Œæš‚æ—¶ä¸ç”¨ï¼›



### 1.1.4 åŠŸèƒ½ç•Œé¢çš„ç»„ä»¶åŒ–ç¼–ç æµç¨‹

>æ‹†åˆ†ç»„ä»¶: æ‹†åˆ†ç•Œé¢,æŠ½å–ç»„ä»¶
>
>å®ç°é™æ€ç»„ä»¶: ä½¿ç”¨ç»„ä»¶å®ç°é™æ€é¡µé¢æ•ˆæœ
>
>å®ç°åŠ¨æ€ç»„ä»¶
>
>â€‹	3.1 åŠ¨æ€æ˜¾ç¤ºåˆå§‹åŒ–æ•°æ®
>
>â€‹		3.1.1 æ•°æ®ç±»å‹
>
>â€‹		3.1.2 æ•°æ®åç§°
>
>â€‹		3.1.2 ä¿å­˜åœ¨å“ªä¸ªç»„ä»¶?
>
>â€‹	3.2 äº¤äº’(ä»ç»‘å®šäº‹ä»¶ç›‘å¬å¼€å§‹)



å¯åŠ¨æµç¨‹ï¼š

1. åœ¨ `src` ä¸‹ `index.js`:
   - å¼•å…¥ react æ ¸å¿ƒåº“ï¼›
   - å¼•å…¥ react-dom æ ¸å¿ƒåº“ï¼›
   - å¼•å…¥ index CSS æ ·å¼ï¼›
   - å¼•å…¥ App ç»„ä»¶ï¼›
   - è§¦å‘ `ReactDOM.render()` æ¸²æŸ“ App ç»„ä»¶ï¼›
     - å¼•å…¥ App ç»„ä»¶æ—¶ï¼Œå°±ä¼šæŠŠç›¸åº”çš„ CSSã€JS ä»£ç å…¨éƒ¨å¼•å…¥ã€‚

1. åœ¨ `index.js` æ–‡ä»¶æ‰§è¡Œåï¼ŒReact é€šè¿‡ webpack çš„é…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ° `src` ä¸‹çš„ `index.html`ï¼š
   - ä¾æ¬¡æ‰§è¡Œ `index.html` ä¸­çš„ç¨‹åºï¼Œ
2. æœ€ç»ˆï¼Œæ¸²æŸ“å‡º `index.html` çš„é¡µé¢ã€‚



## 1.2 å¿«æ·é”®

`rcc`	----------	å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå¯¹è±¡ç»„ä»¶æ¨¡æ¿ï¼›

`rfc`	----------	å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå‡½æ•°ç»„ä»¶æ¨¡æ¿ï¼›

`imp`	----------	å¿«é€Ÿå¼•å…¥ä¸€ä¸ª `import`ï¼›



# 2 todoList æ¡ˆä¾‹ç›¸å…³çŸ¥è¯†ç‚¹

1. æ‹†åˆ†ç»„ä»¶ã€å®ç°é™æ€ç»„ä»¶ï¼Œæ³¨æ„ï¼šclassNameã€styleçš„å†™æ³•ï¼š
   - åœ¨ HTML ä¸­ ï¼š`style="display: none"`
   - åœ¨ JSX ä¸­ ï¼š`style={{display: 'none'}}`



2. åŠ¨æ€åˆå§‹åŒ–åˆ—è¡¨ï¼Œå¦‚ä½•ç¡®å®šå°†æ•°æ®æ”¾åœ¨å“ªä¸ªç»„ä»¶çš„ state ä¸­ï¼Ÿ
   - å¦‚æœæ˜¯æŸä¸ªè‡ªå·±ç»„ä»¶ä½¿ç”¨ï¼šæ”¾åœ¨å…¶è‡ªèº«çš„ state ä¸­ï¼›
   - å¦‚æœæ˜¯å¤šä¸ªç»„ä»¶éƒ½è¦ä½¿ç”¨ï¼šæ”¾åœ¨ä»–ä»¬å…±åŒçš„çˆ¶ç»„ä»¶ state ä¸­ï¼ˆå®˜æ–¹ç§°æ­¤æ“ä½œä¸ºï¼šçŠ¶æ€æå‡ï¼‰ã€‚



3. å…³äºçˆ¶å­ä¹‹é—´é€šä¿¡ï¼š

â€‹        1.ã€çˆ¶ç»„ä»¶ã€‘ç»™ã€å­ç»„ä»¶ã€‘ä¼ é€’æ•°æ®ï¼šé€šè¿‡ `props` ä¼ é€’

â€‹        2.ã€å­ç»„ä»¶ã€‘ç»™ã€çˆ¶ç»„ä»¶ã€‘ä¼ é€’æ•°æ®ï¼šé€šè¿‡ `props` ä¼ é€’ï¼Œè¦æ±‚çˆ¶å­ç»„ä»¶ç»™å­ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå­ç»„ä»¶é€šè¿‡è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼ŒæŠŠæ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚

```js
// çˆ¶ç»„ä»¶
// çˆ¶ç»„ä»¶ä¸­çš„å›è°ƒ
addTodo = (todoObj) =>{
    // è·å–è‡ªèº« state ä¸­åŸæ¥çš„ todos
    const {todos} = this.state
    // åˆ›å»ºä¸€ä¸ªæ–° todoï¼Œæ·»åŠ è·å–çš„æ–° todo
    const newTodos = [todoObj,...todos]
    // æ›´æ–°è‡ªèº« state ä¸­çš„ todos
    this.setState({todos:newTodos})
}
//.....çœç•¥ç»„ä»¶å…¶ä»–é€»è¾‘
//.....çœç•¥ç»„ä»¶å…¶ä»–é€»è¾‘

// åœ¨renderä¸­é€šè¿‡propsä¼ é€’ç»™å­ç»„ä»¶ Header
< Header addTodo=ï½›this.addTodoï½/>
    
// å­ç»„ä»¶
// åœ¨å­ç»„ä»¶çš„äº‹ä»¶è§¦å‘å‡½æ•°ä¸­ä½¿ç”¨è¯¥æ–¹æ³•ï¼š
handleKeyUp = (event) => {
    //... è§¦å‘äº‹ä»¶ä¸­çš„å…¶ä»–é€»è¾‘
    // é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶å‘è¿‡æ¥çš„ addTodo å‡½æ•°ï¼ŒæŠŠè‡ªå·±çš„æ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚
    this.props.addTodo(target.value)
}
```



4. æ³¨æ„ `defaultChecked` å’Œ `checked` çš„åŒºåˆ«ï¼š

è¿™ä¸¤ä¸ªå±æ€§æ˜¯ `input` æ ‡ç­¾ä¸­çš„ï¼Œç”¨æ¥æ ‡è¯†é€‰é¡¹æ˜¯å¦æ‰“é’©ã€‚

- `checked` æ§åˆ¶äº†é€‰é¡¹æ˜¯å¦æ‰“é’©ï¼Œæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¯ä»¥é€šè¿‡ `onChange` å›è°ƒï¼Œç”¨æˆ·ç‚¹å‡»åè¿›è¡Œæ‰“é’©åˆ‡æ¢ï¼›
- `defaultChecked` å±æ€§è®¾å®šäº†åœ¨åˆæ¬¡æ˜¾ç¤º `input` æ ‡ç­¾çš„æ—¶å€™ï¼Œæ ‡ç­¾æ˜¯å¦æ‰“é’©ã€‚

```js
// checked å±æ€§
<input type="checkbox" checked={true} />
    
// defaultChecked å±æ€§
<input type="checkbox" defaultChecked={true} />
```



5. æ³¨æ„ `defaultValue` å’Œ `value` çš„åŒºåˆ«ï¼š





6. çŠ¶æ€åœ¨å“ªé‡Œï¼Œæ“ä½œçŠ¶æ€çš„æ–¹æ³•å°±åœ¨å“ªé‡Œ



\## äºŒã€githubæœç´¢æ¡ˆä¾‹ç›¸å…³çŸ¥è¯†ç‚¹

â€‹    1.è®¾è®¡çŠ¶æ€æ—¶è¦è€ƒè™‘å…¨é¢ï¼Œä¾‹å¦‚å¸¦æœ‰ç½‘ç»œè¯·æ±‚çš„ç»„ä»¶ï¼Œè¦è€ƒè™‘è¯·æ±‚å¤±è´¥æ€ä¹ˆåŠã€‚

â€‹    2.ES6å°çŸ¥è¯†ç‚¹ï¼šè§£æ„èµ‹å€¼+é‡å‘½å

â€‹          let obj = {a:{b:1}}

â€‹          const {a} = obj; //ä¼ ç»Ÿè§£æ„èµ‹å€¼

â€‹          const {a:{b}} = obj; //è¿ç»­è§£æ„èµ‹å€¼

â€‹          const {a:{b:value}} = obj; //è¿ç»­è§£æ„èµ‹å€¼+é‡å‘½å

â€‹    3.æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒæœºåˆ¶

â€‹          1.å…ˆè®¢é˜…ï¼Œå†å‘å¸ƒï¼ˆç†è§£ï¼šæœ‰ä¸€ç§éš”ç©ºå¯¹è¯çš„æ„Ÿè§‰ï¼‰

â€‹          2.é€‚ç”¨äºä»»æ„ç»„ä»¶é—´é€šä¿¡

â€‹          3.è¦åœ¨ç»„ä»¶çš„componentWillUnmountä¸­å–æ¶ˆè®¢é˜…

â€‹    4.fetchå‘é€è¯·æ±‚ï¼ˆå…³æ³¨åˆ†ç¦»çš„è®¾è®¡æ€æƒ³ï¼‰

â€‹          try {

â€‹            const response= await fetch(`/api1/search/users2?q=${keyWord}`)

â€‹            const data = await response.json()

â€‹            console.log(data);

â€‹          } catch (error) {

â€‹            console.log('è¯·æ±‚å‡ºé”™',error);

â€‹          }

â€‹        



\## ä¸‰ã€è·¯ç”±çš„åŸºæœ¬ä½¿ç”¨

â€‹      1.æ˜ç¡®å¥½ç•Œé¢ä¸­çš„å¯¼èˆªåŒºã€å±•ç¤ºåŒº

â€‹      2.å¯¼èˆªåŒºçš„aæ ‡ç­¾æ”¹ä¸ºLinkæ ‡ç­¾

â€‹            <Link to="/xxxxx">Demo</Link>

â€‹      3.å±•ç¤ºåŒºå†™Routeæ ‡ç­¾è¿›è¡Œè·¯å¾„çš„åŒ¹é…

â€‹            <Route path='/xxxx' component={Demo}/>

â€‹      4.<App>çš„æœ€å¤–ä¾§åŒ…è£¹äº†ä¸€ä¸ª<BrowserRouter>æˆ–<HashRouter>



\## å››ã€è·¯ç”±ç»„ä»¶ä¸ä¸€èˆ¬ç»„ä»¶

â€‹      1.å†™æ³•ä¸åŒï¼š

â€‹            ä¸€èˆ¬ç»„ä»¶ï¼š<Demo/>

â€‹            è·¯ç”±ç»„ä»¶ï¼š<Route path="/demo" component={Demo}/>

â€‹      2.å­˜æ”¾ä½ç½®ä¸åŒï¼š

â€‹            ä¸€èˆ¬ç»„ä»¶ï¼šcomponents

â€‹            è·¯ç”±ç»„ä»¶ï¼špages

â€‹      3.æ¥æ”¶åˆ°çš„propsä¸åŒï¼š

â€‹            ä¸€èˆ¬ç»„ä»¶ï¼šå†™ç»„ä»¶æ ‡ç­¾æ—¶ä¼ é€’äº†ä»€ä¹ˆï¼Œå°±èƒ½æ”¶åˆ°ä»€ä¹ˆ

â€‹            è·¯ç”±ç»„ä»¶ï¼šæ¥æ”¶åˆ°ä¸‰ä¸ªå›ºå®šçš„å±æ€§

â€‹                      history:

â€‹                            go: Æ’ go(n)

â€‹                            goBack: Æ’ goBack()

â€‹                            goForward: Æ’ goForward()

â€‹                            push: Æ’ push(path, state)

â€‹                            replace: Æ’ replace(path, state)

â€‹                      location:

â€‹                            pathname: "/about"

â€‹                            search: ""

â€‹                            state: undefined

â€‹                      match:

â€‹                            params: {}

â€‹                            path: "/about"

â€‹                            url: "/about"



\## äº”ã€NavLinkä¸å°è£…NavLink

â€‹        1.NavLinkå¯ä»¥å®ç°è·¯ç”±é“¾æ¥çš„é«˜äº®ï¼Œé€šè¿‡activeClassNameæŒ‡å®šæ ·å¼å



\## å…­ã€Switchçš„ä½¿ç”¨

â€‹        1.é€šå¸¸æƒ…å†µä¸‹ï¼Œpathå’Œcomponentæ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚

â€‹        2.Switchå¯ä»¥æé«˜è·¯ç”±åŒ¹é…æ•ˆç‡(å•ä¸€åŒ¹é…)ã€‚



\## ä¸ƒã€è§£å†³å¤šçº§è·¯å¾„åˆ·æ–°é¡µé¢æ ·å¼ä¸¢å¤±çš„é—®é¢˜

â€‹        1.public/index.html ä¸­ å¼•å…¥æ ·å¼æ—¶ä¸å†™ ./ å†™ / ï¼ˆå¸¸ç”¨ï¼‰

â€‹        2.public/index.html ä¸­ å¼•å…¥æ ·å¼æ—¶ä¸å†™ ./ å†™ %PUBLIC_URL% ï¼ˆå¸¸ç”¨ï¼‰

â€‹        3.ä½¿ç”¨HashRouter



\## å…«ã€è·¯ç”±çš„ä¸¥æ ¼åŒ¹é…ä¸æ¨¡ç³ŠåŒ¹é…

â€‹        1.é»˜è®¤ä½¿ç”¨çš„æ˜¯æ¨¡ç³ŠåŒ¹é…ï¼ˆç®€å•è®°ï¼šã€è¾“å…¥çš„è·¯å¾„ã€‘å¿…é¡»åŒ…å«è¦ã€åŒ¹é…çš„è·¯å¾„ã€‘ï¼Œä¸”é¡ºåºè¦ä¸€è‡´ï¼‰

â€‹        2.å¼€å¯ä¸¥æ ¼åŒ¹é…ï¼š<Route exact={true} path="/about" component={About}/>

â€‹        3.ä¸¥æ ¼åŒ¹é…ä¸è¦éšä¾¿å¼€å¯ï¼Œéœ€è¦å†å¼€ï¼Œæœ‰äº›æ—¶å€™å¼€å¯ä¼šå¯¼è‡´æ— æ³•ç»§ç»­åŒ¹é…äºŒçº§è·¯ç”±



\## ä¹ã€Redirectçš„ä½¿ç”¨   

â€‹        1.ä¸€èˆ¬å†™åœ¨æ‰€æœ‰è·¯ç”±æ³¨å†Œçš„æœ€ä¸‹æ–¹ï¼Œå½“æ‰€æœ‰è·¯ç”±éƒ½æ— æ³•åŒ¹é…æ—¶ï¼Œè·³è½¬åˆ°RedirectæŒ‡å®šçš„è·¯ç”±

â€‹        2.å…·ä½“ç¼–ç ï¼š

â€‹            <Switch>

â€‹              <Route path="/about" component={About}/>

â€‹              <Route path="/home" component={Home}/>

â€‹              <Redirect to="/about"/>

â€‹            </Switch>



\## åã€åµŒå¥—è·¯ç”±

â€‹        1.æ³¨å†Œå­è·¯ç”±æ—¶è¦å†™ä¸Šçˆ¶è·¯ç”±çš„pathå€¼

â€‹        2.è·¯ç”±çš„åŒ¹é…æ˜¯æŒ‰ç…§æ³¨å†Œè·¯ç”±çš„é¡ºåºè¿›è¡Œçš„



\## åä¸€ã€å‘è·¯ç”±ç»„ä»¶ä¼ é€’å‚æ•°

â€‹        1.paramså‚æ•°

â€‹              è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š<Link to='/demo/test/tom/18'}>è¯¦æƒ…</Link>

â€‹              æ³¨å†Œè·¯ç”±(å£°æ˜æ¥æ”¶)ï¼š<Route path="/demo/test/:name/:age" component={Test}/>

â€‹              æ¥æ”¶å‚æ•°ï¼šthis.props.match.params

â€‹        2.searchå‚æ•°

â€‹              è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š<Link to='/demo/test?name=tom&age=18'}>è¯¦æƒ…</Link>

â€‹              æ³¨å†Œè·¯ç”±(æ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯)ï¼š<Route path="/demo/test" component={Test}/>

â€‹              æ¥æ”¶å‚æ•°ï¼šthis.props.location.search

â€‹              å¤‡æ³¨ï¼šè·å–åˆ°çš„searchæ˜¯urlencodedç¼–ç å­—ç¬¦ä¸²ï¼Œéœ€è¦å€ŸåŠ©querystringè§£æ

â€‹        3.stateå‚æ•°

â€‹              è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š<Link to={{pathname:'/demo/test',state:{name:'tom',age:18}}}>è¯¦æƒ…</Link>

â€‹              æ³¨å†Œè·¯ç”±(æ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯)ï¼š<Route path="/demo/test" component={Test}/>

â€‹              æ¥æ”¶å‚æ•°ï¼šthis.props.location.state

â€‹              å¤‡æ³¨ï¼šåˆ·æ–°ä¹Ÿå¯ä»¥ä¿ç•™ä½å‚æ•°

â€‹        





\## åäºŒã€ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª

â€‹          å€ŸåŠ©this.prosp.historyå¯¹è±¡ä¸Šçš„APIå¯¹æ“ä½œè·¯ç”±è·³è½¬ã€å‰è¿›ã€åé€€

â€‹              -this.prosp.history.push()

â€‹              -this.prosp.history.replace()

â€‹              -this.prosp.history.goBack()

â€‹              -this.prosp.history.goForward()

â€‹              -this.prosp.history.go()



\## åä¸‰ã€BrowserRouterä¸HashRouterçš„åŒºåˆ«

â€‹      1.åº•å±‚åŸç†ä¸ä¸€æ ·ï¼š

â€‹            BrowserRouterä½¿ç”¨çš„æ˜¯H5çš„history APIï¼Œä¸å…¼å®¹IE9åŠä»¥ä¸‹ç‰ˆæœ¬ã€‚

â€‹            HashRouterä½¿ç”¨çš„æ˜¯URLçš„å“ˆå¸Œå€¼ã€‚

â€‹      2.pathè¡¨ç°å½¢å¼ä¸ä¸€æ ·

â€‹            BrowserRouterçš„è·¯å¾„ä¸­æ²¡æœ‰#,ä¾‹å¦‚ï¼šlocalhost:3000/demo/test

â€‹            HashRouterçš„è·¯å¾„åŒ…å«#,ä¾‹å¦‚ï¼šlocalhost:3000/#/demo/test

â€‹      3.åˆ·æ–°åå¯¹è·¯ç”±stateå‚æ•°çš„å½±å“

â€‹            (1).BrowserRouteræ²¡æœ‰ä»»ä½•å½±å“ï¼Œå› ä¸ºstateä¿å­˜åœ¨historyå¯¹è±¡ä¸­ã€‚

â€‹            (2).HashRouteråˆ·æ–°åä¼šå¯¼è‡´è·¯ç”±stateå‚æ•°çš„ä¸¢å¤±ï¼ï¼ï¼

â€‹      4.å¤‡æ³¨ï¼šHashRouterå¯ä»¥ç”¨äºè§£å†³ä¸€äº›è·¯å¾„é”™è¯¯ç›¸å…³çš„é—®é¢˜ã€‚



\## åå››ã€antdçš„æŒ‰éœ€å¼•å…¥+è‡ªå®šä¸»é¢˜

â€‹      1.å®‰è£…ä¾èµ–ï¼šyarn add react-app-rewired customize-cra babel-plugin-import less less-loader

â€‹      2.ä¿®æ”¹package.json

â€‹          ....

â€‹            "scripts": {

â€‹              "start": "react-app-rewired start",

â€‹              "build": "react-app-rewired build",

â€‹              "test": "react-app-rewired test",

â€‹              "eject": "react-scripts eject"

â€‹            },

â€‹          ....

â€‹      3.æ ¹ç›®å½•ä¸‹åˆ›å»ºconfig-overrides.js

â€‹          //é…ç½®å…·ä½“çš„ä¿®æ”¹è§„åˆ™

â€‹          const { override, fixBabelImports,addLessLoader} = require('customize-cra');

â€‹          module.exports = override(

â€‹            fixBabelImports('import', {

â€‹              libraryName: 'antd',

â€‹              libraryDirectory: 'es',

â€‹              style: true,

â€‹            }),

â€‹            addLessLoader({

â€‹              lessOptions:{

â€‹                javascriptEnabled: true,

â€‹                modifyVars: { '@primary-color': 'green' },

â€‹              }

â€‹            }),

â€‹          );

â€‹        4.å¤‡æ³¨ï¼šä¸ç”¨åœ¨ç»„ä»¶é‡Œäº²è‡ªå¼•å…¥æ ·å¼äº†ï¼Œå³ï¼šimport 'antd/dist/antd.css'åº”è¯¥åˆ æ‰





















